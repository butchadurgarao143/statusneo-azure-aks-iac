# 1. Initialize Azure CLI
az login
az login --tenant 0d86ebca-48d5-4826-8189-d00318a494f8

# 2. Create resource group and storage for backend
az group create -n alpheya-tfstate-rg -l eastus
az storage account create -n alpheyatfstate01 -g alpheya-tfstate-rg -l eastus --sku Standard_LRS
az storage container create --name tfstate-container --account-name alpheyatfstate01

# 3. Create backend.tfvars
cat <<EOF > backend.tfvars
storage_account_name = "alpheyatfstate01"
container_name       = "tfstate-container"
key                  = "dev.terraform.tfstate"
resource_group_name  = "alpheya-tfstate-rg"
EOF

# 4. Navigate to the dev environment and run Terraform commands
cd ./envs/dev
terraform init -backend-config=../backend.tfvars
terraform plan
terraform apply

# 5. Push code to GitHub and watch Actions pipeline
git init
git remote add origin <your-github-repo-url>
git add .
git commit -m "Initial commit for Alpheya AKS Terraform setup"
git branch -M main
git push -u origin main
